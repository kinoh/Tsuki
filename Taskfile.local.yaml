version: '3'

dotenv: ['.env', '.env.local']

env:
  GIT_HASH:
    sh: git rev-parse HEAD
  DOCKER_HOST: ""

vars:
  DOCKER_COMPOSE: docker compose -f compose.yaml -f compose.dev.yaml

tasks:
  memgraph/local-clean:
    desc: Reset local memgraph database
    cmds:
      - 'echo "MATCH (n) DETACH DELETE n;" | {{.DOCKER_COMPOSE}} exec -T memgraph mgconsole'
  local-reset:
    desc: Reset local data
    cmds:
      - task -t Taskfile.yaml sandbox/restore/latest
      - task -t Taskfile.yaml memgraph/restore/latest
      - task -t core/Taskfile.yaml reset-data
