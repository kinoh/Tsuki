--- a/dist/chunk-GFALVOBW.cjs
+++ b/dist/chunk-GFALVOBW.cjs
@@ -10547,9 +10547,30 @@
       });
     }
     if (chunk.type !== "reasoning-start" && chunk.type !== "reasoning-delta" && chunk.type !== "reasoning-end" && chunk.type !== "redacted-reasoning" && chunk.type !== "reasoning-signature" && chunk.type !== "response-metadata" && runState.state.isReasoning) {
+      const providerMetadata = runState.state.providerOptions;
+      if (providerMetadata || runState.state.reasoningDeltas.length > 0) {
+        const message = {
+          id: messageId,
+          role: "assistant",
+          content: {
+            format: 2,
+            parts: [
+              {
+                type: "reasoning",
+                reasoning: "",
+                details: [{ type: "text", text: runState.state.reasoningDeltas.join("") }],
+                ...providerMetadata ? { providerMetadata } : {}
+              }
+            ]
+          },
+          createdAt: /* @__PURE__ */ new Date()
+        };
+        messageList.add(message, "response");
+      }
       runState.setState({
         isReasoning: false,
-        reasoningDeltas: []
+        reasoningDeltas: [],
+        providerOptions: void 0
       });
     }
     switch (chunk.type) {
@@ -10563,6 +10584,15 @@
           }
         });
         break;
+      case "text-start": {
+        runState.setState({
+          providerOptions: chunk.payload.providerMetadata ?? runState.state.providerOptions
+        });
+        if (isControllerOpen(controller)) {
+          controller.enqueue(chunk);
+        }
+        break;
+      }
       case "text-delta": {
         const textDeltasFromState = runState.state.textDeltas;
         textDeltasFromState.push(chunk.payload.text);
@@ -10575,6 +10605,15 @@
         }
         break;
       }
+      case "text-end": {
+        runState.setState({
+          providerOptions: chunk.payload.providerMetadata ?? runState.state.providerOptions
+        });
+        if (isControllerOpen(controller)) {
+          controller.enqueue(chunk);
+        }
+        break;
+      }
       case "tool-call-input-streaming-start": {
         const tool2 = tools?.[chunk.payload.toolName] || Object.values(tools || {})?.find((tool3) => `id` in tool3 && tool3.id === chunk.payload.toolName);
         if (tool2 && "onInputStart" in tool2) {
@@ -10660,6 +10699,12 @@
         break;
       }
       case "reasoning-end": {
+        if (!runState.state.isReasoning && runState.state.reasoningDeltas.length === 0 && !runState.state.providerOptions) {
+          if (isControllerOpen(controller)) {
+            controller.enqueue(chunk);
+          }
+          break;
+        }
         const message = {
           id: messageId,
           role: "assistant",
--- a/dist/chunk-2XX35XRX.js
+++ b/dist/chunk-2XX35XRX.js
@@ -10519,9 +10519,30 @@
       });
     }
     if (chunk.type !== "reasoning-start" && chunk.type !== "reasoning-delta" && chunk.type !== "reasoning-end" && chunk.type !== "redacted-reasoning" && chunk.type !== "reasoning-signature" && chunk.type !== "response-metadata" && runState.state.isReasoning) {
+      const providerMetadata = runState.state.providerOptions;
+      if (providerMetadata || runState.state.reasoningDeltas.length > 0) {
+        const message = {
+          id: messageId,
+          role: "assistant",
+          content: {
+            format: 2,
+            parts: [
+              {
+                type: "reasoning",
+                reasoning: "",
+                details: [{ type: "text", text: runState.state.reasoningDeltas.join("") }],
+                ...providerMetadata ? { providerMetadata } : {}
+              }
+            ]
+          },
+          createdAt: /* @__PURE__ */ new Date()
+        };
+        messageList.add(message, "response");
+      }
       runState.setState({
         isReasoning: false,
-        reasoningDeltas: []
+        reasoningDeltas: [],
+        providerOptions: void 0
       });
     }
     switch (chunk.type) {
@@ -10535,6 +10556,15 @@
           }
         });
         break;
+      case "text-start": {
+        runState.setState({
+          providerOptions: chunk.payload.providerMetadata ?? runState.state.providerOptions
+        });
+        if (isControllerOpen(controller)) {
+          controller.enqueue(chunk);
+        }
+        break;
+      }
       case "text-delta": {
         const textDeltasFromState = runState.state.textDeltas;
         textDeltasFromState.push(chunk.payload.text);
@@ -10547,6 +10577,15 @@
         }
         break;
       }
+      case "text-end": {
+        runState.setState({
+          providerOptions: chunk.payload.providerMetadata ?? runState.state.providerOptions
+        });
+        if (isControllerOpen(controller)) {
+          controller.enqueue(chunk);
+        }
+        break;
+      }
       case "tool-call-input-streaming-start": {
         const tool2 = tools?.[chunk.payload.toolName] || Object.values(tools || {})?.find((tool3) => `id` in tool3 && tool3.id === chunk.payload.toolName);
         if (tool2 && "onInputStart" in tool2) {
@@ -10632,6 +10671,12 @@
         break;
       }
       case "reasoning-end": {
+        if (!runState.state.isReasoning && runState.state.reasoningDeltas.length === 0 && !runState.state.providerOptions) {
+          if (isControllerOpen(controller)) {
+            controller.enqueue(chunk);
+          }
+          break;
+        }
         const message = {
           id: messageId,
           role: "assistant",
